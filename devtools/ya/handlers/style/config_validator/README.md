# Валидатор конфигов

Библиотека предназначена для проверки настроек, указанных в файле конфигурации на предмет непротиворечивости правилами, задаваемыми в другом файле конфигурации. На данный момент, первичная цель библиотеки - проверка пользовательских линтерных конфигов.

Файл с правилами задается в формате yaml и содержит несколько секций, см. [json схему](https://a.yandex-team.ru/arcadia/build/tests/config/linter_configs/data/validation_rules_schema.json):
1. `config_settings`: тут указываются настройки, задающие способ интерпретации файла конфигурации.
2. `rules`: секция содержит список правил (ассоциативных массивов). Для каждого правила задается путь к полю проверяемого конфига, тип правила и настройки, специфичные для типа правила.

В правилах есть возможность ссылаться на значения базового файла конфигурации через указание маркера `$base`. Это может быть удобно если разрешенные или запрещенные значения должны повторять те, что указаны в базовом файле конфигурации.

Для добавления конфига с правилами необходимо:
1. Создать конфиг с правилами в формате yaml и положить его в `build/tests/config` в подходящий каталог, например в соответствии с ЯП. Добавить маппинг в один из [configs_validation_rules.json](https://a.yandex-team.ru/arcadia/build/plugins/lib/test_const/__init__.py?rev=r16207362#L469-470), ключ - название линтера, значение - путь к файлу с правилами.
2. Дополнить [маппинг](https://a.yandex-team.ru/arcadia/build/plugins/lib/test_const/__init__.py?rev=r16207362#L487)
3. Зарелизить `devtools/pr_checks/checker` и `devtools/ya/bin`. Нужно учесть, что у них разный релизный цикл, соответственно `build/plugins/lib/test_const/__init__.py` обновляется не одновременно.
